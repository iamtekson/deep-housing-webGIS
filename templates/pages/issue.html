{% extends 'base.html' %}
{% block title %} Issue {% endblock title %}
{% block css %}
<style>
    .nav-bar {
        z-index: 1100 !important;
    }

    .issue {
        margin-top: 120px;
    }

    .issue-body {
        padding-right: 50px;
    }

    .issue-1 {
        padding: 30px 0;
    }

    .sidebar-issue {
        padding: 20px 10px;
        background: #eee;
        border: 1px solid #ccc;
        border-radius: 10px;
    }
</style>
{% endblock css %}

{% block content %}
{% include "partials/_navindex.html" %}
<section class="container issue">
    <div class="row">
        <div class="col-8 issue-body">
            <div class="issue-1">
                <h1>Issue on pipeline</h1>
                <p> <i>Issue Publish on: 2019-07-23</i></p>
                <p>In developing countries like ours where cities are not properly planned and organized, mapping of
                    utilities sector can play a major role in the development of that country or place. Utilities like
                    water lines, sewage system, telephone lines, internet lines, etc. are not properly documented and
                    even if they are properly documented, they are in low quality maps. Reliable information regarding
                    them can be of great help which can help in efficient service delivery.</p>
                <div class='map' id="map" style="width: 100%; height:300px"></div>
                <a href="#" class="btn"><button class="btn-info mt-3">Goto Web-map</button></a>
            </div>

            <div class="issue-1">
                <h1>Issue on pipeline</h1>
                <p> <i>Issue Publish on: 2019-07-23</i></p>
                <p>In developing countries like ours where cities are not properly planned and organized, mapping of
                    utilities sector can play a major role in the development of that country or place. Utilities like
                    water lines, sewage system, telephone lines, internet lines, etc. are not properly documented and
                    even if they are properly documented, they are in low quality maps. Reliable information regarding
                    them can be of great help which can help in efficient service delivery.</p>
                <div class='map' style="width: 100%; height:300px"></div>
                <a href="#" class="btn" utton class="btn-info mt-3">Goto Web-map</button></a>
            </div>

        </div>
        <div class="col-4 sidebar-issue">
            <h3 class="sidebar-header">Top most issues</h3>
            <ul>
                <a href="#" class="sidebar-issue">
                    <li>Issue on pipeline 1 </li>
                </a>
                <a href="#">
                    <li>Issue on pipeline</li>
                </a>
                <a href="#">
                    <li>Issue on pipeline</li>
                </a>
                <a href="#">
                    <li>Issue on pipeline</li>
                </a>
                <a href="#">
                    <li>Issue on pipeline</li>
                </a>
                <a href="#">
                    <li>Issue on pipeline</li>
                </a>
                <a href="#">
                    <li>Issue on pipeline</li>
                </a>
            </ul>
        </div>
    </div>
</section>
{% include "partials/_footer.html" %}

{% endblock content %}

{% block js %}
<script>

    //issue-map
    var map = L.map('map').setView([28.2521, 83.9774], 18);

    //map scale
    scale = L.control.scale().addTo(map),

        //osm baselayer
        osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);


    // circle marker style
    mystyle = {
        radius: 30,
        fillColor: "#ff7800",
        color: "#000",
        weight: 3,
        opacity: .7,
        fillOpacity: 0.5
    }
    //marker
    var issueMarker = L.marker([28.2521, 83.9774]).addTo(map).bindPopup('Issue on Pipe network').openPopup(),
        issueMarkerCircle = L.circleMarker([28.2521, 83.9774], mystyle).addTo(map)

    userMarker = false
    function addIssue() {
        $('.btn').click(function () {
            if (userMarker) {

                console.log('run')
                map.on('click', function (e) {
                    var marker = new L.Marker([e.latlng.lat, e.latlng.lng], { draggable: true, title: 'hover text' }).addTo(map).bindPopup('popup').openPopup(),
                        circleMarkr = new L.circleMarker([e.latlng.lat, e.latlng.lng], mystyle).addTo(map)
                })
            }
            else {
                map.off('click')
            }
            userMarker = !userMarker
        });
    }
    addIssue()

</script>
{% endblock js %}